import{b as ne,c as oe,e as re,f as le,g as ae,h as ce,i as me}from"./chunk-SPBPX3CJ.js";import{a as $,b as se}from"./chunk-FDMXM43G.js";import"./chunk-KGH2FHVB.js";import{a as U,b as j,c as N,f as O,i as z,n as H,v as B,w as A}from"./chunk-P66PUL4X.js";import{T as V,ca as L,fa as R}from"./chunk-VRRHNQBJ.js";import"./chunk-Q3UCUI45.js";import{$ as _,Db as w,Fb as p,Gb as c,Ja as G,Ka as S,Kb as ee,Lb as te,Mb as ie,Na as F,Oa as a,Rb as W,Sb as k,Ta as J,Tb as T,Ua as b,Ub as d,Vb as I,Wb as D,Zb as E,_ as f,_a as M,a as P,b as y,fb as K,ia as v,nb as x,ob as h,pb as X,rb as Q,sb as Z,tb as C,ub as r,vb as s,wb as m}from"./chunk-JGGDHNN7.js";var ve=()=>({width:"20px",height:"20px"});function be(o,t){if(o&1&&(r(0,"p",11),d(1),s()),o&2){let e=c(2);a(),I(e.selectedFileName)}}function Ce(o,t){o&1&&(r(0,"div",13)(1,"h1"),d(2,"Updating\u2026"),s(),m(3,"p-progress-spinner",14),s()),o&2&&(a(3),k(E(2,ve)))}function we(o,t){o&1&&d(0," Update ")}function Pe(o,t){if(o&1){let e=w();r(0,"div",0)(1,"div",4)(2,"i",5),p("click",function(){f(e);let n=c();return _(n.user.showUploadForm.set(!1))}),s(),r(3,"h2",6),d(4," Upload Profile Picture "),s(),r(5,"div",7)(6,"label",8),m(7,"i",9),d(8," Choose Picture "),s(),r(9,"input",10),p("change",function(n){f(e);let l=c();return _(l.onFileSelected(n))}),s(),x(10,be,2,1,"p",11),r(11,"button",12),p("click",function(){f(e);let n=c();return _(n.uploadProfilePicture())}),x(12,Ce,4,3,"div",13)(13,we,1,0),s()()()()}if(o&2){let e=c();a(9),C("formControl",e.profilePicture),a(),h(e.selectedFileName?10:-1),a(),C("disabled",e.profilePicture.invalid),a(),h(e.spinner()?12:13)}}var Y=class o{constructor(t,e){this.user=t;this.message=e}profilePicture=new O(null,j.required);selectedFileName="";spinner=v(!1);clickListener(t){let e=t.target;this.user.showUploadForm()===!0&&!e.closest(".picForm")&&!e.closest(".cameraBtn")&&this.user.showUploadForm.set(!1)}onFileSelected(t){let e=t.target.files?.[0];e&&(this.profilePicture.setValue(e),this.selectedFileName=e.name)}uploadProfilePicture(){if(this.profilePicture.invalid)return;this.spinner.set(!0);let t=this.profilePicture.value,e=new FormData;e.append("photo",t),this.user.uploadPersonalPhoto(e).subscribe({next:i=>{this.spinner.set(!1),this.user.getUserInfo().subscribe(n=>this.user.userImg.set(n.image)),console.log(i),this.message.add({severity:"success",summary:"Success Process",detail:"Your Profile Ptcture updated successfully"}),this.user.showUploadForm.set(!1)},error:i=>console.log(i)})}static \u0275fac=function(e){return new(e||o)(b($),b(V))};static \u0275cmp=M({type:o,selectors:[["app-profile-img"]],hostBindings:function(e,i){e&1&&p("click",function(l){return i.clickListener(l)},F)},decls:4,vars:2,consts:[[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],["alt","Profile",1,"w-full","h-full","rounded-full","object-cover","shadow-lg",3,"src"],[1,"w-[40px]","h-[40px]","absolute","top-0","right-[-5px]","bg-white/40","rounded-full","flex","justify-center","items-center","backdrop-blur-sm"],[1,"CameraBtn","fas","fa-camera","text-[30px]","text-[#66849c]","cursor-pointer",3,"click"],[1,"picForm","bg-[#66849c]","rounded-2xl","p-6","w-[90%]","sm:w-[400px]","text-center","shadow-lg","relative","animate-fadeIn"],[1,"fas","fa-times","absolute","top-3","right-3","text-gray-500","cursor-pointer","hover:text-black","transition",3,"click"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"flex","flex-col","items-center","gap-4"],["for","fileInput",1,"cursor-pointer","flex","items-center","justify-center","gap-2","px-4","py-2","bg-teal-500","text-white","rounded-lg","hover:bg-teal-600","transition"],[1,"fas","fa-upload"],["type","file","id","fileInput","accept","image/*","hidden","",3,"change","formControl"],[1,"text-sm","text-gray-600"],[1,"mt-3","bg-teal-600","text-white","px-5","py-2","rounded-lg","hover:bg-teal-700","transition","disabled:opacity-50",3,"click","disabled"],[1,"flex","items-center","justify-center"],["strokeWidth","8","fill","transparent","animationDuration",".5s"]],template:function(e,i){e&1&&(x(0,Pe,14,4,"div",0),m(1,"img",1),r(2,"div",2)(3,"i",3),p("click",function(l){return i.user.showUploadForm.set(!0),l.stopPropagation()}),s()()),e&2&&(h(i.user.showUploadForm()?0:-1),a(),C("src",i.user.userImg()||"./images/d-user.jpg",S))},dependencies:[H,U,N,z,L,R,A,B],encapsulation:2})};var ye=["post"],pe=()=>({width:"20px",height:"20px"}),Se=(o,t)=>t._id;function ke(o,t){o&1&&(r(0,"div",18)(1,"h1"),d(2,"Updating\u2026"),s(),m(3,"p-progress-spinner",19),s()),o&2&&(a(3),k(E(2,pe)))}function Ie(o,t){o&1&&d(0," Update ")}function Ee(o,t){if(o&1){let e=w();r(0,"div",1)(1,"div",12),p("click",function(){f(e);let n=c();return _(n.updateForm.set(null))}),s(),r(2,"div",13)(3,"i",14),p("click",function(){f(e);let n=c();return _(n.updateForm.set(null))}),s(),r(4,"h2",15),d(5,"Update Your Post"),s(),m(6,"textarea",16),r(7,"button",17),p("click",function(){f(e);let n=c();return _(n.onUpdate())}),x(8,ke,4,3,"div",18)(9,Ie,1,0),s()()()}if(o&2){let e=c();a(6),C("formControl",e.textControl),a(),C("disabled",e.textControl.invalid),a(),h(e.spinner()?8:9)}}function Fe(o,t){o&1&&(r(0,"div",18)(1,"h1"),d(2,"Sharing\u2026"),s(),m(3,"p-progress-spinner",19),s()),o&2&&(a(3),k(E(2,pe)))}function Me(o,t){o&1&&d(0," Go Share ")}function Te(o,t){if(o&1){let e=w();r(0,"div",38)(1,"h2",39),d(2,"Ready to share ?"),s(),r(3,"button",40),p("click",function(n){f(e);let l=c(3);return l.sharePost(l.shareId()),_(n.stopPropagation())}),x(4,Fe,4,3,"div",18)(5,Me,1,0),s()()}if(o&2){let e=c(3);T(e.shareId()?"opacity-[1] translate-y-[-70px]":"opacity-0 translate-y-[0]"),a(4),h(e.spinner()?4:5)}}function De(o,t){if(o&1&&m(0,"h2",31),o&2){let e=c().$implicit;C("innerHTML",e.body,G)}}function Ve(o,t){if(o&1&&(r(0,"div",32),m(1,"img",41),s()),o&2){let e=c().$implicit;a(),C("src",e.image,S)}}function Ue(o,t){if(o&1){let e=w();r(0,"i",42),p("click",function(n){f(e);let l=c().$implicit;return c(2).options(l._id),_(n.stopPropagation())}),s(),r(1,"div",43),p("click",function(n){return f(e),_(n.stopPropagation())}),r(2,"div",44),p("click",function(){f(e);let n=c().$implicit,l=c(2);return _(l.openUpdateForm(n))}),m(3,"i",45),s(),r(4,"div",46)(5,"i",47),p("click",function(){f(e);let n=c(3);return _(n.onDelete(n.showOptions()))}),s()()()}if(o&2){let e=c().$implicit,i=c(2);W("rotate-45",i.showOptions()===e._id),a(),T(i.showOptions()===e._id?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-3 pointer-events-none")}}function je(o,t){if(o&1&&(r(0,"div",37),m(1,"div",48),r(2,"div",49),m(3,"img",50),s(),r(4,"div",51)(5,"h3",52),d(6),s(),r(7,"h4",53),d(8),r(9,"span",54),d(10,"|"),s(),r(11,"span",55),d(12),s()()()()),o&2){let e=c().$implicit;a(6),D(" ",e.comments[0].commentCreator.name," "),a(2),D(" @",e.user.name," "),a(4),I(e.comments[0].content)}}function Ne(o,t){if(o&1){let e=w();r(0,"div",20,0),x(2,Te,6,3,"div",21),r(3,"div",22),m(4,"div",23),r(5,"div",24),m(6,"img",25),s(),m(7,"div",26),s(),r(8,"div",27)(9,"div",28)(10,"h1",29),d(11),s(),r(12,"h3",30),d(13),s()(),x(14,De,1,1,"h2",31),x(15,Ve,2,1,"div",32),r(16,"div",33)(17,"i",34),p("click",function(){let n=f(e).$implicit,l=c(2);return _(l.makeHeart(n._id))}),s(),r(18,"i",35),p("click",function(){let n=f(e).$implicit,l=c(2);return l.commentsFunc(),_(l.callComments(n._id))}),s(),r(19,"i",36),p("click",function(n){let l=f(e).$implicit;return c(2).readyToShare(l._id),_(n.stopPropagation())}),s(),x(20,Ue,6,4),s(),x(21,je,13,3,"div",37),s()()}if(o&2){let e=t.$implicit,i=c(2);a(2),h(i.shareId()===e._id?2:-1),a(4),C("src",i.user.userImg()||e.user.photo,S)("alt",e.user.name+" personal photo"),a(5),I(e.user.name),a(2),D(" ",i.edit.getTimeAgo(e.createdAt)," "),a(),h(e.body?14:-1),a(),h(e.image?15:-1),a(),W("w-[190px]",e.user._id===i.userID())("w-[140px]",e.user._id!==i.userID()),a(),T(i.heart()[e._id]?"fas fa-heart":"far fa-heart"),a(3),h(e.user._id===i.userID()?20:-1),a(),h(e.comments[0]?21:-1)}}function Oe(o,t){if(o&1&&Q(0,Ne,22,15,"div",20,Se),o&2){let e,i=c();Z((e=i.userPosts())==null?null:e.posts)}}function ze(o,t){o&1&&(r(0,"div",11),m(1,"img",56),r(2,"h1",57)(3,"span",58),d(4,"Opps"),s(),d(5,"No posts Yet... "),s()())}function He(o,t){o&1&&(r(0,"div",59)(1,"div",60),m(2,"p-skeleton",61),r(3,"div",27),m(4,"p-skeleton",62)(5,"p-skeleton",63)(6,"p-skeleton",64),r(7,"div",65),m(8,"p-skeleton",66),s()()()())}function Le(o,t){if(o&1&&Q(0,He,9,0,"div",59,X),o&2){let e=c();Z(e.shimmer)}}var de=class o{constructor(t,e,i,n,l,u,g){this.user=t;this.render=e;this.zone=i;this.posts=n;this.comments=l;this.edit=u;this.message=g}showOptions=v(null);userID=v(void 0);userPosts=v(null);page=1;postID=v("");shimmer=[...Array(5)];showShimmer=v(!0);updateForm=v(null);shareId=v(null);spinner=v(!1);heart=v({});Post;readyToShare(t){this.shareId.set(t)}openUpdateForm(t){this.updateForm.set(t._id),this.textControl.setValue(t.body)}clickListener(t){let e=t.target;!e.closest(".options-wrapper")&&this.showOptions()&&!e.closest(".plus-icon")?this.showOptions.set(null):e.closest("popUp-share")||this.shareId.set(null)}options(t){this.showOptions.set(this.showOptions()===t?null:t)}commentsFunc(){this.comments.showComments.set(!this.comments.showComments())}makeHeart(t){let e=this.heart()[t]||!1;this.heart.update(i=>y(P({},i),{[t]:!e}))}ngOnInit(){this.user.getUserInfo().subscribe(t=>{this.userID.set(t.id),this.profilePosts()})}profilePosts(){this.userID()&&this.user.getPersonalPosts(this.userID()).subscribe({next:t=>{this.userPosts.set(t),this.user.userImg.set(t.posts[0].user.photo),this.showShimmer.set(!1),setTimeout(()=>{this.waitForImagesThenMeasure()},0)},error:t=>console.error(t.message)})}sharePost(t){t&&(this.spinner.set(!0),this.posts.postDetails(t).subscribe({next:e=>{let i=e.post,n=new FormData,l=`${i.body||""}<br /><span
        class="font-normal text-teal-600 text-[14px]"
      >@shared from ${i.user?.name||"Unknown"}</span>`;n.append("body",l),i.image?fetch(i.image).then(u=>u.blob()).then(u=>{let g=new File([u],"shared.jpg",{type:u.type});n.append("image",g),this.posts.createPost(n).subscribe({next:()=>{this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post shared Successfully..."}),this.shareId.set(null)},error:q=>{this.spinner.set(!1),console.error(q)}})}):this.posts.createPost(n).subscribe({next:()=>{this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post shared Successfully..."}),this.shareId.set(null)},error:u=>{this.spinner.set(!1),console.error(u)}})},error:e=>{this.spinner.set(!1),console.error(e)}}))}waitForImagesThenMeasure(){this.zone.runOutsideAngular(()=>{setTimeout(()=>{let e=Array.from(document.querySelectorAll("img"));if(e.length===0)return;let i=0,n=()=>{i++,i===e.length&&this.zone.run(()=>this.whatDistance())};e.forEach(l=>{l.complete?n():(l.addEventListener("load",n),l.addEventListener("error",n))})},0)})}whatDistance(){let t=this.Post.toArray();console.log(t),t.forEach(e=>{let i=e.nativeElement.querySelector(".owner"),n=e.nativeElement.querySelector(".commentUser"),l=e.nativeElement.querySelector(".line");if(!n){this.render.setStyle(l,"display","none");return}let u=i.getBoundingClientRect();console.log(u);let g=n.getBoundingClientRect();console.log(g);let q=Math.abs(g.top-u.top+25);this.render.setStyle(l,"height",`${q}px`),this.render.setStyle(l,"display","block")})}callComments(t){this.comments.postID.set(t)}textControl=new O("",[j.required]);onUpdate(){if(this.spinner.set(!0),this.textControl.invalid)return;let t=new FormData;t.append("body",this.textControl.value??"");let e=this.updateForm();console.log(e),e&&this.posts.updatePost(e,t).subscribe({next:i=>{let n=this.userPosts();if(!n)return;let l=n.posts??[],u=l.findIndex(g=>g._id===e);if(u>-1){let g=[...l];g[u]=y(P({},g[u]),{body:this.textControl.value??g[u].body}),this.userPosts.set(y(P({},n),{posts:g,paginationInfo:n.paginationInfo}))}this.textControl.reset(),this.updateForm.set(null),this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post Updated Successfully..."})},error:i=>console.error(i)})}onDelete(t){t&&this.posts.deletePost(t).subscribe({next:()=>{this.userPosts.update(e=>e&&y(P({},e),{posts:e.posts.filter(i=>i._id!==t)})),this.message.add({severity:"warn",summary:"Success Process",detail:"Your Post Deleted..."})},error:e=>console.log(e)})}static \u0275fac=function(e){return new(e||o)(b($),b(J),b(K),b(re),b(se),b(le),b(V))};static \u0275cmp=M({type:o,selectors:[["app-profile"]],viewQuery:function(e,i){if(e&1&&ee(ye,5),e&2){let n;te(n=ie())&&(i.Post=n)}},hostBindings:function(e,i){e&1&&p("click",function(l){return i.clickListener(l)},F)},decls:20,vars:2,consts:[["post",""],[1,"fixed","inset-0","flex","items-center","justify-center","z-50"],[1,"w-full","flex","flex-col","bg-[#26323b]","md:w-[50%]","mx-auto","md:mx-px","md:ms-auto","relative","z-[1]"],[1,"relative","mb-4","px-4","py-7","border-b-2","border-gray-600","bg-gradient-to-r","from-[#2e3a44]","to-[#26323b]","flex","items-center"],[1,"absolute","left-0","top-0","h-full","w-[5px]","bg-[rgb(5,218,129)]","rounded-r-lg"],[1,"relative","w-[90px]","h-[90px]","me-4","mb-2"],[1,"flex","flex-col","mb-1"],[1,"text-[rgb(5,218,129)]","font-mono","text-[22px]","leading-none"],[1,"text-white","font-bold","text-[20px]","leading-none"],[1,"text-[16px]","shimmer-text","font-[Pacifico]"],[1,""],[1,"relative"],[1,"absolute","inset-0","bg-black/60","backdrop-blur-sm",3,"click"],[1,"relative","bg-[#475763]","rounded-2xl","p-6","w-[90%]","sm:w-[400px]","text-center","shadow-lg","z-10","animate-fadeIn"],[1,"fas","fa-times","absolute","top-3","right-3","text-gray-500","cursor-pointer","hover:text-black","transition",3,"click"],[1,"text-lg","font-semibold","text-white","mb-4"],["rows","5","placeholder","Type something...",1,"w-full","p-3","bg-[#6e8ba1]","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-teal-500","resize-none",3,"formControl"],[1,"mt-4","bg-teal-600","text-white","px-5","py-2","rounded-lg","hover:bg-teal-700","transition","disabled:opacity-50",3,"click","disabled"],[1,"flex","items-center","justify-center"],["strokeWidth","8","fill","transparent","animationDuration",".5s"],[1,"relative","flex","justify-around","bg-[#26323b]","border-b-4","p-4","pb-7","border-gray-400"],[1,"absolute","popUp-share","py-3","w-[92%]","flex","justify-between","gap-3","bottom-[-65px]","h-fit","z-30","p-2","bg-teal-500/50","rounded-xl","transition-all","duration-1000",3,"class"],[1,"relative","p-[2px]","self-start","ms-auto","pb-5","me-2"],[1,"z-20","absolute","top-0","w-[100px]","h-1","bg-[#26323b]"],[1,"owner","pointer-events-none","relative","z-20","bg-[#26323b]","h-[60px]"],[1,"rounded-full","w-[50px]","h-[50px]",3,"src","alt"],[1,"line","pointer-events-none","z-10","absolute","top-0","left-[50%]","w-[70px]","border-l-[3px]","border-b-[3px]","border-gray-400","rounded-[20px]"],[1,"flex","flex-col","w-[80%]"],[1,"flex","justify-between","items-center","pt-4","mb-5"],[1,"text-white","font-bold","text-[13px]"],[1,"text-green-200","text-[13px]","font-normal"],[1,"text-white/85","text-[19px]","font-normal","mb-1","break-words",3,"innerHTML"],[1,"flex","gap-1","w-full","mb-2"],[1,"mb-3","relative","border-[2px]","border-gray-700","bg-[#3d4d58]","self-end","flex","justify-around","items-center","rounded-3xl","h-[35px]","p-1","px-5"],[1,"text-[18px]","text-red-400","hover:text-[26px]","transition-all","duration-150","cursor-pointer",3,"click"],[1,"text-[#1e2830]","fas","fa-comment","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"text-green-300","fas","fa-share","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"flex","gap-2","items-start","relative","z-20"],[1,"absolute","popUp-share","py-3","w-[92%]","flex","justify-between","gap-3","bottom-[-65px]","h-fit","z-30","p-2","bg-teal-500/50","rounded-xl","transition-all","duration-1000"],[1,"text-[18px]","text-white","font-bold"],[1,"bg-blue-300","px-2","py-1","rounded-3xl","text-teal-600","font-mono","active:scale-[100.9%]",3,"click"],["alt","post",1,"max-h-[450px]","object-contain","rounded-md",3,"src"],[1,"text-white","plus-icon","fas","fa-plus","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"absolute","options-wrapper","right-[-15%]","-translate-x-1/2","flex","flex-col","gap-2","transition-all","duration-200",3,"click"],[1,"w-8","h-8","bg-white/35","rounded-full","flex","justify-center","items-center","cursor-pointer",3,"click"],[1,"fas","fa-pen","text-teal-400","text-[14px]"],[1,"w-8","h-8","bg-white/35","rounded-full","flex","justify-center","items-center","cursor-pointer"],[1,"fas","fa-trash","text-red-400","text-[14px]",3,"click"],[1,"z-20","absolute","left-[-8px]","top-5","w-2","h-5","bg-[#26323b]"],[1,"w-[45px]","h-[45px]","pt-2"],["src","./images/instgram user.png","alt","comment user",1,"commentUser","w-[100%]","rounded-[50%]","bg-white"],[1,"flex","flex-col"],[1,"text-white","font-semibold"],[1,"font-light","text-green-300"],[1,"text-[22px]","me-1"],[1,"text-gray-500","font-mono"],["src","./images/uploading-file-illustration-svg-download-png-11254005.webp","alt","cover for no post",1,"opacity-[0.5]","py-2"],[1,"text-[40px]","absolute","top-[50%]","left-[50%]","translate-x-[-50%]","translate-y-[-50%]","font-[Pacifico]","text-white"],[1,"block"],[1,"rounded","bg-[#26323b]","border","border-surface-200","dark:border-surface-700","p-6","bg-surface-0","dark:bg-surface-900"],[1,"flex","mb-4"],["shape","circle","size","3rem",1,"mr-2"],["width","5rem",1,"mb-2"],["width","10rem",1,"mb-2"],["height","150px",1,"w-full"],[1,"self-end","mt-4"],["width","5rem","height","1rem"]],template:function(e,i){if(e&1&&(x(0,Ee,10,3,"div",1),m(1,"app-chat"),r(2,"div",2)(3,"div",3),m(4,"div",4),r(5,"div")(6,"div",5),m(7,"app-profile-img"),s(),r(8,"div",6)(9,"h3",7),d(10," Hi "),s(),r(11,"h2",8),d(12," Mohamed Omar "),s()(),r(13,"p",9),d(14," You will find all your thoughts here... "),s()()(),m(15,"app-create")(16,"app-comments",10),x(17,Oe,2,0)(18,ze,6,0,"div",11)(19,Le,2,0),s()),e&2){let n;h(i.updateForm()?0:-1),a(17),h(!((n=i.userPosts())==null||n.posts==null)&&n.posts.length&&!i.showShimmer()?17:(((n=i.userPosts())==null||n.posts==null?null:n.posts.length)??0)===0&&!i.showShimmer()?18:i.showShimmer()?19:-1)}},dependencies:[ae,ce,Y,oe,ne,H,U,N,z,L,R,A,B,me],styles:[".shimmer-text[_ngcontent-%COMP%]{background:linear-gradient(90deg,#999,#fff 20%,#999 40% 100%);background-size:200% auto;color:transparent;background-clip:text;-webkit-background-clip:text;animation:_ngcontent-%COMP%_shimmerMove 2s linear infinite}@keyframes _ngcontent-%COMP%_shimmerMove{0%{background-position:100% center}to{background-position:-100% center}}"]})};export{de as Profile};
