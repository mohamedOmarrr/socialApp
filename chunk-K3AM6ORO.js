import{b as X,c as ee,e as N,f as ne,g as oe,h as re,i as se,j as ce,k as me}from"./chunk-JLDP4KQB.js";import"./chunk-LYPC3CRQ.js";import{a as T,b as D,c as M,f as V,i as U,n as j,w as le,x as ae}from"./chunk-HSXVTTNV.js";import{S as K,ba as te,ea as ie}from"./chunk-JFNJHXSR.js";import"./chunk-Q3UCUI45.js";import{$ as g,Cb as y,Eb as p,Fb as c,Ja as q,Jb as G,Ka as k,Kb as W,Lb as J,Ma as B,Na as a,Qb as L,Rb as H,Sa as Y,Sb as E,Ta as b,Tb as d,Ub as S,Vb as F,Yb as A,Za as I,_ as h,a as C,b as P,eb as Q,ia as v,mb as f,nb as _,ob as Z,qb as R,rb as $,sb as w,tb as r,ub as s,vb as m}from"./chunk-CDDVTM4M.js";function he(o,t){if(o&1&&(r(0,"p",8),d(1),s()),o&2){let e=c();a(),S(e.selectedFileName)}}var z=class o{constructor(t){this.user=t}profilePicture=new V(null,D.required);selectedFileName="";onFileSelected(t){let e=t.target.files?.[0];e&&(this.profilePicture.setValue(e),this.selectedFileName=e.name)}uploadProfilePicture(){if(this.profilePicture.invalid)return;let t=this.profilePicture.value,e=new FormData;e.append("photo",t),this.user.uploadPersonalPhoto(e).subscribe({next:i=>{console.log(i),this.user.showUploadForm.set(!1)},error:i=>console.log(i)})}static \u0275fac=function(e){return new(e||o)(b(N))};static \u0275cmp=I({type:o,selectors:[["app-profile-img"]],decls:13,vars:3,consts:[[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"bg-[#66849c]","rounded-2xl","p-6","w-[90%]","sm:w-[400px]","text-center","shadow-lg","relative","animate-fadeIn"],[1,"fas","fa-times","absolute","top-3","right-3","text-gray-500","cursor-pointer","hover:text-black","transition",3,"click"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"flex","flex-col","items-center","gap-4"],["for","fileInput",1,"cursor-pointer","flex","items-center","justify-center","gap-2","px-4","py-2","bg-teal-500","text-white","rounded-lg","hover:bg-teal-600","transition"],[1,"fas","fa-upload"],["type","file","id","fileInput","accept","image/*","hidden","",3,"change","formControl"],[1,"text-sm","text-gray-600"],[1,"mt-3","bg-teal-600","text-white","px-5","py-2","rounded-lg","hover:bg-teal-700","transition","disabled:opacity-50",3,"click","disabled"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"i",2),p("click",function(){return i.user.showUploadForm.set(!1)}),s(),r(3,"h2",3),d(4," Upload Profile Picture "),s(),r(5,"div",4)(6,"label",5),m(7,"i",6),d(8," Choose Picture "),s(),r(9,"input",7),p("change",function(l){return i.onFileSelected(l)}),s(),f(10,he,2,1,"p",8),r(11,"button",9),p("click",function(){return i.uploadProfilePicture()}),d(12," Upload "),s()()()()),e&2&&(a(9),w("formControl",i.profilePicture),a(),_(i.selectedFileName?10:-1),a(),w("disabled",i.profilePicture.invalid))},dependencies:[j,T,M,U],encapsulation:2})};var ge=["post"],pe=()=>({width:"20px",height:"20px"}),ve=(o,t)=>t._id;function be(o,t){o&1&&m(0,"app-profile-img")}function we(o,t){o&1&&(r(0,"div",21)(1,"h1"),d(2,"Updating\u2026"),s(),m(3,"p-progress-spinner",22),s()),o&2&&(a(3),H(A(2,pe)))}function Ce(o,t){o&1&&d(0," Update ")}function Pe(o,t){if(o&1){let e=y();r(0,"div",1)(1,"div",15),p("click",function(){h(e);let n=c();return g(n.updateForm.set(null))}),s(),r(2,"div",16)(3,"i",17),p("click",function(){h(e);let n=c();return g(n.updateForm.set(null))}),s(),r(4,"h2",18),d(5,"Update Your Post"),s(),m(6,"textarea",19),r(7,"button",20),p("click",function(){h(e);let n=c();return g(n.onUpdate())}),f(8,we,4,3,"div",21)(9,Ce,1,0),s()()()}if(o&2){let e=c();a(6),w("formControl",e.textControl),a(),w("disabled",e.textControl.invalid),a(),_(e.spinner()?8:9)}}function ye(o,t){o&1&&(r(0,"div",21)(1,"h1"),d(2,"Sharing\u2026"),s(),m(3,"p-progress-spinner",22),s()),o&2&&(a(3),H(A(2,pe)))}function Se(o,t){o&1&&d(0," Go Share ")}function ke(o,t){if(o&1){let e=y();r(0,"div",41)(1,"h2",42),d(2,"Ready to share ?"),s(),r(3,"button",43),p("click",function(n){h(e);let l=c(3);return l.sharePost(l.shareId()),g(n.stopPropagation())}),f(4,ye,4,3,"div",21)(5,Se,1,0),s()()}if(o&2){let e=c(3);E(e.shareId()?"opacity-[1] translate-y-[-70px]":"opacity-0 translate-y-[0]"),a(4),_(e.spinner()?4:5)}}function Ie(o,t){if(o&1&&m(0,"h2",34),o&2){let e=c().$implicit;w("innerHTML",e.body,q)}}function Ee(o,t){if(o&1&&(r(0,"div",35),m(1,"img",44),s()),o&2){let e=c().$implicit;a(),w("src",e.image,k)}}function Fe(o,t){if(o&1){let e=y();r(0,"i",45),p("click",function(n){h(e);let l=c().$implicit;return c(2).options(l._id),g(n.stopPropagation())}),s(),r(1,"div",46),p("click",function(n){return h(e),g(n.stopPropagation())}),r(2,"div",47),p("click",function(){h(e);let n=c().$implicit,l=c(2);return g(l.openUpdateForm(n))}),m(3,"i",48),s(),r(4,"div",49)(5,"i",50),p("click",function(){h(e);let n=c(3);return g(n.onDelete(n.showOptions()))}),s()()()}if(o&2){let e=c().$implicit,i=c(2);L("rotate-45",i.showOptions()===e._id),a(),E(i.showOptions()===e._id?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-3 pointer-events-none")}}function Te(o,t){if(o&1&&(r(0,"div",40),m(1,"div",51),r(2,"div",52),m(3,"img",53),s(),r(4,"div",54)(5,"h3",55),d(6),s(),r(7,"h4",56),d(8),r(9,"span",57),d(10,"|"),s(),r(11,"span",58),d(12),s()()()()),o&2){let e=c().$implicit;a(6),F(" ",e.comments[0].commentCreator.name," "),a(2),F(" @",e.user.name," "),a(4),S(e.comments[0].content)}}function De(o,t){if(o&1){let e=y();r(0,"div",23,0),f(2,ke,6,3,"div",24),r(3,"div",25),m(4,"div",26),r(5,"div",27),m(6,"img",28),s(),m(7,"div",29),s(),r(8,"div",30)(9,"div",31)(10,"h1",32),d(11),s(),r(12,"h3",33),d(13),s()(),f(14,Ie,1,1,"h2",34),f(15,Ee,2,1,"div",35),r(16,"div",36)(17,"i",37),p("click",function(){let n=h(e).$implicit,l=c(2);return g(l.makeHeart(n._id))}),s(),r(18,"i",38),p("click",function(){let n=h(e).$implicit,l=c(2);return l.commentsFunc(),g(l.callComments(n._id))}),s(),r(19,"i",39),p("click",function(n){let l=h(e).$implicit;return c(2).readyToShare(l._id),g(n.stopPropagation())}),s(),f(20,Fe,6,4),s(),f(21,Te,13,3,"div",40),s()()}if(o&2){let e=t.$implicit,i=c(2);a(2),_(i.shareId()===e._id?2:-1),a(4),w("src",e.user.photo,k)("alt",e.user.name+" personal photo"),a(5),S(e.user.name),a(2),F(" ",i.edit.getTimeAgo(e.createdAt)," "),a(),_(e.body?14:-1),a(),_(e.image?15:-1),a(),L("w-[190px]",e.user._id===i.userID())("w-[140px]",e.user._id!==i.userID()),a(),E(i.heart()[e._id]?"fas fa-heart":"far fa-heart"),a(3),_(e.user._id===i.userID()?20:-1),a(),_(e.comments[0]?21:-1)}}function Me(o,t){if(o&1&&R(0,De,22,15,"div",23,ve),o&2){let e,i=c();$((e=i.userPosts())==null?null:e.posts)}}function Ve(o,t){o&1&&(r(0,"div",14),m(1,"img",59),r(2,"h1",60)(3,"span",61),d(4,"Opps"),s(),d(5,"No posts Yet... "),s()())}function Ue(o,t){o&1&&(r(0,"div",62)(1,"div",63),m(2,"p-skeleton",64),r(3,"div",30),m(4,"p-skeleton",65)(5,"p-skeleton",66)(6,"p-skeleton",67),r(7,"div",68),m(8,"p-skeleton",69),s()()()())}function je(o,t){if(o&1&&R(0,Ue,9,0,"div",62,Z),o&2){let e=c();$(e.shimmer)}}var de=class o{constructor(t,e,i,n,l,u,x){this.user=t;this.render=e;this.zone=i;this.posts=n;this.comments=l;this.edit=u;this.message=x}showOptions=v(null);userID=v(void 0);userPosts=v(null);page=1;postID=v("");shimmer=[...Array(5)];showShimmer=v(!0);updateForm=v(null);shareId=v(null);spinner=v(!1);heart=v({});Post;readyToShare(t){this.shareId.set(t)}openUpdateForm(t){this.updateForm.set(t._id),this.textControl.setValue(t.body)}clickListener(t){let e=t.target;!e.closest(".options-wrapper")&&this.showOptions()&&!e.closest(".plus-icon")?this.showOptions.set(null):e.closest("popUp-share")||this.shareId.set(null)}options(t){this.showOptions.set(this.showOptions()===t?null:t)}commentsFunc(){this.comments.showComments.set(!this.comments.showComments())}makeHeart(t){let e=this.heart()[t]||!1;this.heart.update(i=>P(C({},i),{[t]:!e}))}ngOnInit(){this.user.getUserInfo().subscribe(t=>{this.userID.set(t.id),this.profilePosts()})}profilePosts(){this.userID()&&this.user.getPersonalPosts(this.userID()).subscribe({next:t=>{this.userPosts.set(t),this.showShimmer.set(!1),setTimeout(()=>{this.waitForImagesThenMeasure()},0)},error:t=>console.error(t.message)})}sharePost(t){t&&(this.spinner.set(!0),this.posts.postDetails(t).subscribe({next:e=>{let i=e.post,n=new FormData,l=`${i.body||""}<br /><span
        class="font-normal text-teal-600 text-[14px]"
      >@shared from ${i.user?.name||"Unknown"}</span>`;n.append("body",l),i.image?fetch(i.image).then(u=>u.blob()).then(u=>{let x=new File([u],"shared.jpg",{type:u.type});n.append("image",x),this.posts.createPost(n).subscribe({next:()=>{this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post shared Successfully..."}),this.shareId.set(null)},error:O=>{this.spinner.set(!1),console.error(O)}})}):this.posts.createPost(n).subscribe({next:()=>{this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post shared Successfully..."}),this.shareId.set(null)},error:u=>{this.spinner.set(!1),console.error(u)}})},error:e=>{this.spinner.set(!1),console.error(e)}}))}waitForImagesThenMeasure(){this.zone.runOutsideAngular(()=>{setTimeout(()=>{let e=Array.from(document.querySelectorAll("img"));if(e.length===0)return;let i=0,n=()=>{i++,i===e.length&&this.zone.run(()=>this.whatDistance())};e.forEach(l=>{l.complete?n():(l.addEventListener("load",n),l.addEventListener("error",n))})},0)})}whatDistance(){let t=this.Post.toArray();console.log(t),t.forEach(e=>{let i=e.nativeElement.querySelector(".owner"),n=e.nativeElement.querySelector(".commentUser"),l=e.nativeElement.querySelector(".line");if(!n){this.render.setStyle(l,"display","none");return}let u=i.getBoundingClientRect();console.log(u);let x=n.getBoundingClientRect();console.log(x);let O=Math.abs(x.top-u.top+25);this.render.setStyle(l,"height",`${O}px`),this.render.setStyle(l,"display","block")})}callComments(t){this.comments.postID.set(t)}textControl=new V("",[D.required]);onUpdate(){if(this.spinner.set(!0),this.textControl.invalid)return;let t=new FormData;t.append("body",this.textControl.value??"");let e=this.updateForm();console.log(e),e&&this.posts.updatePost(e,t).subscribe({next:i=>{let n=this.userPosts();if(!n)return;let l=n.posts??[],u=l.findIndex(x=>x._id===e);if(u>-1){let x=[...l];x[u]=P(C({},x[u]),{body:this.textControl.value??x[u].body}),this.userPosts.set(P(C({},n),{posts:x,paginationInfo:n.paginationInfo}))}this.textControl.reset(),this.updateForm.set(null),this.spinner.set(!1),this.message.add({severity:"success",summary:"Success Process",detail:"Your Post Updated Successfully..."})},error:i=>console.error(i)})}onDelete(t){t&&this.posts.deletePost(t).subscribe({next:()=>{this.userPosts.update(e=>e&&P(C({},e),{posts:e.posts.filter(i=>i._id!==t)})),this.message.add({severity:"warn",summary:"Success Process",detail:"Your Post Deleted..."})},error:e=>console.log(e)})}static \u0275fac=function(e){return new(e||o)(b(N),b(Y),b(Q),b(ne),b(oe),b(re),b(K))};static \u0275cmp=I({type:o,selectors:[["app-profile"]],viewQuery:function(e,i){if(e&1&&G(ge,5),e&2){let n;W(n=J())&&(i.Post=n)}},hostBindings:function(e,i){e&1&&p("click",function(l){return i.clickListener(l)},B)},decls:23,vars:4,consts:[["post",""],[1,"fixed","inset-0","flex","items-center","justify-center","z-50"],[1,"w-full","flex","flex-col","bg-[#26323b]","md:w-[50%]","mx-auto","md:mx-px","md:ms-auto","relative","z-[1]"],[1,"relative","mb-4","px-4","py-7","border-b-2","border-gray-600","bg-gradient-to-r","from-[#2e3a44]","to-[#26323b]","flex","items-center"],[1,"absolute","left-0","top-0","h-full","w-[5px]","bg-[rgb(5,218,129)]","rounded-r-lg"],[1,"relative","w-[90px]","h-[90px]","me-4","mb-2"],["alt","Profile",1,"w-full","h-full","rounded-full","object-cover","shadow-lg",3,"src"],[1,"w-[40px]","h-[40px]","absolute","top-0","right-[-5px]","bg-white/40","rounded-full","flex","justify-center","items-center","backdrop-blur-sm"],[1,"fas","fa-camera","text-[30px]","text-[#66849c]","cursor-pointer",3,"click"],[1,"flex","flex-col","mb-1"],[1,"text-[rgb(5,218,129)]","font-mono","text-[22px]","leading-none"],[1,"text-white","font-bold","text-[20px]","leading-none"],[1,"text-[16px]","shimmer-text","font-[Pacifico]"],[1,""],[1,"relative"],[1,"absolute","inset-0","bg-black/60","backdrop-blur-sm",3,"click"],[1,"relative","bg-[#475763]","rounded-2xl","p-6","w-[90%]","sm:w-[400px]","text-center","shadow-lg","z-10","animate-fadeIn"],[1,"fas","fa-times","absolute","top-3","right-3","text-gray-500","cursor-pointer","hover:text-black","transition",3,"click"],[1,"text-lg","font-semibold","text-white","mb-4"],["rows","5","placeholder","Type something...",1,"w-full","p-3","bg-[#6e8ba1]","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-teal-500","resize-none",3,"formControl"],[1,"mt-4","bg-teal-600","text-white","px-5","py-2","rounded-lg","hover:bg-teal-700","transition","disabled:opacity-50",3,"click","disabled"],[1,"flex","items-center","justify-center"],["strokeWidth","8","fill","transparent","animationDuration",".5s"],[1,"relative","flex","justify-around","bg-[#26323b]","border-b-4","p-4","pb-7","border-gray-400"],[1,"absolute","popUp-share","py-3","w-[92%]","flex","justify-between","gap-3","bottom-[-65px]","h-fit","z-30","p-2","bg-teal-500/50","rounded-xl","transition-all","duration-1000",3,"class"],[1,"relative","p-[2px]","self-start","ms-auto","pb-5","me-2"],[1,"z-20","absolute","top-0","w-[100px]","h-1","bg-[#26323b]"],[1,"owner","pointer-events-none","relative","z-20","bg-[#26323b]","h-[60px]"],[1,"rounded-full","w-[50px]","h-[50px]",3,"src","alt"],[1,"line","pointer-events-none","z-10","absolute","top-0","left-[50%]","w-[70px]","border-l-[3px]","border-b-[3px]","border-gray-400","rounded-[20px]"],[1,"flex","flex-col","w-[80%]"],[1,"flex","justify-between","items-center","pt-4","mb-5"],[1,"text-white","font-bold","text-[13px]"],[1,"text-green-200","text-[13px]","font-normal"],[1,"text-white/85","text-[19px]","font-normal","mb-1",3,"innerHTML"],[1,"flex","gap-1","w-full","mb-2"],[1,"mb-3","relative","border-[2px]","border-gray-700","bg-[#3d4d58]","self-end","flex","justify-around","items-center","rounded-3xl","h-[35px]","p-1","px-5"],[1,"text-[18px]","text-red-400","hover:text-[26px]","transition-all","duration-150","cursor-pointer",3,"click"],[1,"text-[#1e2830]","fas","fa-comment","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"text-green-300","fas","fa-share","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"flex","gap-2","items-start","relative","z-20"],[1,"absolute","popUp-share","py-3","w-[92%]","flex","justify-between","gap-3","bottom-[-65px]","h-fit","z-30","p-2","bg-teal-500/50","rounded-xl","transition-all","duration-1000"],[1,"text-[18px]","text-white","font-bold"],[1,"bg-blue-300","px-2","py-1","rounded-3xl","text-teal-600","font-mono","active:scale-[100.9%]",3,"click"],["alt","post",1,"max-h-[450px]","object-contain","rounded-md",3,"src"],[1,"text-white","plus-icon","fas","fa-plus","cursor-pointer","hover:text-[24px]","transition-all","duration-150",3,"click"],[1,"absolute","options-wrapper","right-[-15%]","-translate-x-1/2","flex","flex-col","gap-2","transition-all","duration-200",3,"click"],[1,"w-8","h-8","bg-white/35","rounded-full","flex","justify-center","items-center","cursor-pointer",3,"click"],[1,"fas","fa-pen","text-teal-400","text-[14px]"],[1,"w-8","h-8","bg-white/35","rounded-full","flex","justify-center","items-center","cursor-pointer"],[1,"fas","fa-trash","text-red-400","text-[14px]",3,"click"],[1,"z-20","absolute","left-[-8px]","top-5","w-2","h-5","bg-[#26323b]"],[1,"w-[45px]","h-[45px]","pt-2"],["src","./images/instgram user.png","alt","comment user",1,"commentUser","w-[100%]","rounded-[50%]","bg-white"],[1,"flex","flex-col"],[1,"text-white","font-semibold"],[1,"font-light","text-green-300"],[1,"text-[22px]","me-1"],[1,"text-gray-500","font-mono"],["src","./images/uploading-file-illustration-svg-download-png-11254005.webp","alt","cover for no post",1,"opacity-[0.5]","py-2"],[1,"text-[40px]","absolute","top-[50%]","left-[50%]","translate-x-[-50%]","translate-y-[-50%]","font-[Pacifico]","text-white"],[1,"block"],[1,"rounded","bg-[#26323b]","border","border-surface-200","dark:border-surface-700","p-6","bg-surface-0","dark:bg-surface-900"],[1,"flex","mb-4"],["shape","circle","size","3rem",1,"mr-2"],["width","5rem",1,"mb-2"],["width","10rem",1,"mb-2"],["height","150px",1,"w-full"],[1,"self-end","mt-4"],["width","5rem","height","1rem"]],template:function(e,i){if(e&1&&(f(0,be,1,0,"app-profile-img"),f(1,Pe,10,3,"div",1),m(2,"app-chat"),r(3,"div",2)(4,"div",3),m(5,"div",4),r(6,"div")(7,"div",5),m(8,"img",6),r(9,"div",7)(10,"i",8),p("click",function(){return i.user.showUploadForm.set(!0)}),s()()(),r(11,"div",9)(12,"h3",10),d(13," Hi "),s(),r(14,"h2",11),d(15," Mohamed Omar "),s()(),r(16,"p",12),d(17," You will find all your thoughts here... "),s()()(),m(18,"app-create")(19,"app-comments",13),f(20,Me,2,0)(21,Ve,6,0,"div",14)(22,je,2,0),s()),e&2){let n,l;_(i.user.showUploadForm()?0:-1),a(),_(i.updateForm()?1:-1),a(7),w("src",((n=i.userPosts())==null||n.posts==null||n.posts[0]==null||n.posts[0].user==null?null:n.posts[0].user.photo)||"./images/d-user.jpg",k),a(12),_(!((l=i.userPosts())==null||l.posts==null)&&l.posts.length&&!i.showShimmer()?20:(((l=i.userPosts())==null||l.posts==null?null:l.posts.length)??0)===0&&!i.showShimmer()?21:i.showShimmer()?22:-1)}},dependencies:[se,ce,z,ee,X,j,T,M,U,te,ie,ae,le,me],styles:[".shimmer-text[_ngcontent-%COMP%]{background:linear-gradient(90deg,#999,#fff 20%,#999 40% 100%);background-size:200% auto;color:transparent;background-clip:text;-webkit-background-clip:text;animation:_ngcontent-%COMP%_shimmerMove 2s linear infinite}@keyframes _ngcontent-%COMP%_shimmerMove{0%{background-position:100% center}to{background-position:-100% center}}"]})};export{de as Profile};
